{% extends "base.html" %}
{% block body %}
<h1>Wharf: {{ app }}</h1>
<a href="{{ url('index') }}">Return to apps index</a><br />

<h3>Actions</h3>
{% if git_url == None %}
Can't deploy due to missing GITHUB_URL in config
{% else %}
<form class="form-inline" action="{{ url('deploy', app_name=app) }}" method="POST">
  {% csrf_token %}
  <input type="hidden" name="url" value="{{ git_url }}" />
  <button type="submit" class="btn btn-primary">Deploy app</button>
</form>
{% endif %}
<h2>Config</h2>
<ul class=config>
  {% for (k,v) in config %}
    <li>{{ k }} = {{ v }}</li>
  {% endfor %}
</ul>
<h3>New item</h3>
<form action="{{ url('app_info', app_name=app) }}" method="POST">
  {% csrf_token %}
  {{ form | bootstrap }}
  <input class="form-control" type="submit" value="Submit" />
</form>
<h3>Postgres</h3>
{% if postgres %}
Status: {{ postgres['STATUS'] }}
{% else %}
<form class="form-inline" action="{{ url('create_postgres', app_name=app) }}" method="POST">
  {% csrf_token %}
  <button type="submit" class="btn btn-primary">Create postgres db</button>
</form>
{% endif %}
<h3>Redis</h3>
{% if redis %}
Status: {{ redis['STATUS'] }}
{% else %}
<form class="form-inline" action="{{ url('create_redis', app_name=app) }}" method="POST">
  {% csrf_token %}
  <button type="submit" class="btn btn-primary">Create redis db</button>
</form>
{% endif %}
<h3>Let's Encrypt</h3>
{% if letsencrypt %}
{{ letsencrypt }}
{% else %}
<form class="form-inline" action="{{ url('setup_letsencrypt', app_name=app) }}" method="POST">
  {% csrf_token %}
  <button type="submit" class="btn btn-primary">Setup Let's Encrypt</button>
</form>
{% endif %}
{% endblock %}